# 我々はマイクロサービスとどう向き合うべきか

https://speakerdeck.com/ota42y/how-should-we-face-with-microservices-wo-hamaikurosabisutodouxiang-kihe-ubekika

## よかった点

### 日々の開発速度が上がった
* CIが４０分->5分
* クラス構造も依存が少ない

### 影響範囲がとても小さい
* Model数十個とか
* 見通しやすいので、新し人にも優しい

### 専用チームでPDCAを回せる
* 意思決定速度が早くなった

### どんどん新機能を作る戦略ともマッチした

## 辛い点

### ランキングサービス
* モノリスと分割できたし、ロジックも凝集できてよかった
* セキュリティ対応が手薄になった（一人でやっていて、誰もカバーできなかった）
  * 横断的に把握できるような仕組みを設けた
  * 週二時間の割れ窓を直す時間を確保した
* ドメインが成長して変わる
  * 徐々に機能が増えてきたことで、他のmicroserviceと結合した
  * サービス横断的に機能開発する必要が出てきた
  * 本当は他のサービスのモジュールにしておけばよかったらしい
* 成長予測は難しい。DHHですら3回書き直してた

## マイクロサービスの統合

Martin Fowlerも、２つ同時に変更することが何度もあれば、一つに戻すべき、と言ってる


## これらの問題はマイクロサービス特有ではない

ただ、問題が何倍にも増幅されるし、リファクタリングもモノリスより大変。

## 組織の成長で対応できる複雑性が上がる

FiNCでは事業部レベルでの分割がうまく行っている
機能ベースでマイクロサービス化するのは辛そうだからやめておいたほうが良さそう

## 辛くならない程度にマイクロサービス化したい

* ラッパーマイクロサービス
モノリスの前にmsを置く（ストラングラーパターン？）

* マイクロサービスへの寄生
BFFの一部に寄生しているモジュール

## Railsとmicroservice

Railsは小〜中規模のサービスには向いていて、マイクロサービスにも向いている
Railsは密結合になりやすく、分割するのが大変
密結合を解きつつ分割するのが大切

複数システムを横断した時のTransaction
Sage
